<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <style>
        body {
            direction: rtl;
            text-align: right;
            line-height: 1rem;
            font-family: Tahoma;
            background: #eee;
        }

        .dir-left {
            direction: ltr;
            text-align: left;
        }

        .text-center {
            text-align: center;
        }

        .container {
            padding: 15px;
            background: #fff;
            margin: 10px;
        }

        ul {}

        ul li {
            margin: 5px;
        }

        ul li a {
            text-decoration: none;
        }

        .seprator {
            margin-bottom: 50px;
        }

        table {
            width: 100%;
            border: 1px solid #bdbdbd;
        }

        table th {}

        table td {}

        table th,
        table td {
            padding: 5px;
            border: 1px solid #dbdbdb;
        }

        h4 {
            margin-top: 55px;
        }
    </style>
</head>

<body>
    <div class="container">
        <p class="text-center">
            بسمه تعالی
        </p>
        <h2 class="text-center">مستند فراخوانی api واسط ارسال صورتحساب</h1>

            <ul>
                <li>
                    <a href="#part-1">
                        دریافت اطلاعات سرور
                    </a>
                </li>
                <li>
                    <a href="#part-2">
                        دریافت توکن
                    </a>
                </li>
                <li>
                    <a href="#part-3">
                        دریافت اطلاعات حافظه مالیاتی
                    </a>
                </li>
                <li>
                    <a href="#part-4">
                        استعلام کد اقتصادی
                    </a>
                </li>
                <li>
                    <a href="#part-5">
                        ارسال صورتحساب
                    </a>
                </li>
                <li>
                    <a href="#part-6">
                        استعلام صورتحساب
                    </a>
                </li>
            </ul>

            <h4>نکات عمومی</h4>
            <ul>
                <li>
                    در تمامی پاسخ های دریافتی پارامتر status نشان دهنده وضعیت پاسخ می باشد اگر true باشد موفق و اگر
                    false نتیجه ناموفق است
                </li>
                <li>
                    در تمامی پاسخ های دریافتی پارامتر code نشان دهنده نوع خطا می باشد
                    <ul>
                        <li>اگر 0 باشد یعنی خطایی وجود ندارد</li>
                        <li>
                            اگر 1 باشد خطای سازمان
                        </li>
                        <li>
                            اگر 2 باشد خطای validation api خودمان
                        </li>
                        <li>
                            اگر 500 باشد خطای کامپایل api خودمان
                        </li>
                    </ul>
                </li>
                <li>
                    در تمامی پاسخ های دریافتی اگر اطلاعاتی از طرف سازمان دریاف گردد در فیلد data قرار می گیرد
                </li>
                <li>
                    در تمامی پاسخ های دریافتی فیلد message پیامی از طرف api خودمان هست
                </li>
            </ul>

    </div>
    <div class="seprator">

    </div>

    <div id="part-1" class="container">
        <h3>
            دریافت اطلاعات سرور
        </h3>
        <div>
            <table class="dir-left">
                <thead>
                    <tr>
                        <th>
                            url
                        </th>
                        <th>
                            method
                        </th>
                        <th>
                            inputs
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            /helper/get_server_information
                        </td>
                        <td>
                            post
                        </td>
                        <td>
                            ندارد
                        </td>
                    </tr>
                </tbody>
            </table>
            <h4>
                خروجی تابع
            </h4>
            <table class="dir-left">
                <thead>
                    <tr>
                        <th>موفق</th>
                        <th>ناموفق</th>
                        <th>خطا</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>{ status: true, code: 0, data: response, message: 'success' }</td>
                        <td>{ status: false, code: 1, data: error, message: 'faided' }</td>
                        <td>{ status: false, data: {}, code: 500, message: err }
                        </td>
                    </tr>
                    <tr>
                        <td>response : دیتای دریافتی از طرف سازمان</td>
                        <td>error : خطای دریافتی از طرف سازمان</td>
                        <td>err : خطای کامپایل در سرور خودمان</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    <div class="seprator">

    </div>

    <div id="part-2" class="container">
        <h3>
            دریافت توکن
        </h3>
        <div>
            <table class="dir-left">
                <thead>
                    <tr>
                        <th>
                            url
                        </th>
                        <th>
                            method
                        </th>
                        <th>
                            inputs
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            /helper/get_token
                        </td>
                        <td>
                            post
                        </td>
                        <td>
                            client_id
                        </td>
                    </tr>
                </tbody>
            </table>
            <h4>
                validation
            </h4>
            <table class="dir-left">
                <thead>
                    <tr>
                        <th>پارامتر</th>
                        <th>وضعیت</th>
                        <th>پاسخ</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>client_id</td>
                        <td>خالی</td>
                        <td>{ status: false, code: 2, message: ' حافظه مالیاتی معتبر نیست', data: {}, help: { client_id:
                            '...' } }</td>
                    </tr>
                </tbody>
            </table>
            <h4>
                خروجی تابع
            </h4>
            <table class="dir-left">
                <thead>
                    <tr>
                        <th>موفق</th>
                        <th>ناموفق</th>
                        <th>خطا</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>{ status: true, code: 0, data: { token: response }, message: 'get token success' }</td>
                        <td>{ status: false, code: 1, data: error, message: 'get token faided' }</td>
                        <td>{ status: false, data: {}, code: 500, message: err }
                        </td>
                    </tr>
                    <tr>
                        <td>response : دیتای دریافتی از طرف سازمان</td>
                        <td>error : خطای دریافتی از طرف سازمان</td>
                        <td>err : خطای کامپایل در سرور خودمان</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    <div class="seprator">

    </div>

    <div id="part-3" class="container">
        <h3>
            دریافت اطلاعات حافظه مالیاتی
        </h3>
        <div>
            <table class="dir-left">
                <thead>
                    <tr>
                        <th>
                            url
                        </th>
                        <th>
                            method
                        </th>
                        <th>
                            inputs
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            /helper/get_fiscal_information
                        </td>
                        <td>
                            post
                        </td>
                        <td>
                            client_id
                        </td>
                    </tr>
                </tbody>
            </table>
            <h4>
                validation
            </h4>
            <table class="dir-left">
                <thead>
                    <tr>
                        <th>پارامتر</th>
                        <th>وضعیت</th>
                        <th>پاسخ</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>client_id</td>
                        <td>خالی</td>
                        <td>{ status: false, code: 2, message: ' حافظه مالیاتی معتبر نیست', data: {}, help: { client_id:
                            '...' } }</td>
                    </tr>
                </tbody>
            </table>
            <h4>
                خروجی تابع
            </h4>
            <table class="dir-left">
                <thead>
                    <tr>
                        <th>موفق</th>
                        <th>ناموفق</th>
                        <th>خطا</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>{ status: true, code: 0, data: response, message: ' GET_FISCAL_INFORMATION success' }</td>
                        <td>{ status: false, code: 1, data: error, message: 'GET_FISCAL_INFORMATION faided' }</td>
                        <td>{ status: false, data: {}, code: 500, message: err }
                        </td>
                    </tr>
                    <tr>
                        <td>response : دیتای دریافتی از طرف سازمان</td>
                        <td>error : خطای دریافتی از طرف سازمان</td>
                        <td>err : خطای کامپایل در سرور خودمان</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div class="seprator">

    </div>

    <div id="part-4" class="container">
        <h3>
            استعلام کد اقتصادی
        </h3>
        <div>
            <table class="dir-left">
                <thead>
                    <tr>
                        <th>
                            url
                        </th>
                        <th>
                            method
                        </th>
                        <th>
                            inputs
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            /helper/get_economic_code_information
                        </td>
                        <td>
                            post
                        </td>
                        <td>
                            client_id
                        </td>
                    </tr>
                </tbody>
            </table>
            <h4>
                validation
            </h4>
            <table class="dir-left">
                <thead>
                    <tr>
                        <th>پارامتر</th>
                        <th>وضعیت</th>
                        <th>پاسخ</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>economicCode</td>
                        <td>خالی</td>
                        <td>{ status: false, code: 2, message: ' شماره اقتصادی معتبر نیست', data: {}, help: {
                            economicCode: '...' } }</td>
                    </tr>
                </tbody>
            </table>
            <h4>
                خروجی تابع
            </h4>
            <table class="dir-left">
                <thead>
                    <tr>
                        <th>موفق</th>
                        <th>ناموفق</th>
                        <th>خطا</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>{ status: true, code: 0, data: response, message: ' get_economic_code_information success' }
                        </td>
                        <td>{ status: false, code: 1, data: error, message: 'get_economic_code_information faided' }
                        </td>
                        <td>{ status: false, data: {}, code: 500, message: err }
                        </td>
                    </tr>
                    <tr>
                        <td>response : دیتای دریافتی از طرف سازمان</td>
                        <td>error : خطای دریافتی از طرف سازمان</td>
                        <td>err : خطای کامپایل در سرور خودمان</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div class="seprator">

    </div>

    <div id="part-5" class="container">
        <h3>
            ارسال صورتحساب
        </h3>
        <div>
            <table class="dir-left">
                <thead>
                    <tr>
                        <th>
                            url
                        </th>
                        <th>
                            method
                        </th>
                        <th>
                            inputs
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            /invoice/send_invoice
                        </td>
                        <td>
                            post
                        </td>
                        <td>
                            { client_id: '...', invoices: [{ header: {}, body: [{}, {}], payments: [{}, {}], extension:
                            null }] }
                        </td>
                    </tr>
                </tbody>
            </table>
            <h4>
                validation
            </h4>
            <table class="dir-left">
                <thead>
                    <tr>
                        <th>پارامتر</th>
                        <th>وضعیت</th>
                        <th>پاسخ</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>inputs</td>
                        <td>خالی</td>
                        <td>{ status: false, code: 2, message:[{ key: 'inputs', message: 'پارامترهای ورودی معتبر نیست'
                            }] , data: {} }</td>
                    </tr>
                    <tr>
                        <td>inputs.client_id</td>
                        <td>خالی</td>
                        <td>{ status: false, code: 2, message:[{ key: 'inputs.client_id', message: ' حافظه مالیاتی معتبر
                            نیست' }], data: {} }</td>
                    </tr>
                    <tr>
                        <td>invoices</td>
                        <td>خالی</td>
                        <td>{ status: false, code: 2, message:[{ key: 'invoices', message: ' صورتحساب معتبر نیست' }],
                            data: {} }</td>
                    </tr>
                    <tr>
                        <td>invoices[x].header (x=ردیف)</td>
                        <td>خالی</td>
                        <td>{ status: false, code: 2, message: [ { index: x, key: 'invoices[x].header', message: 'سربرگ
                            صورتحساب معتبر نیست' }], data: {} }</td>
                    </tr>
                    <tr>
                        <td>invoices[x].body (x=ردیف)</td>
                        <td>خالی</td>
                        <td>{ status: false, code: 2, message: [ { index: x, key: 'invoices[x].body', message: 'بدنه
                            صورتحساب معتبر نیست' }], data: {} }</td>
                    </tr>
                    <tr>
                        <td>invoices[x].payments (x=ردیف)</td>
                        <td>خالی</td>
                        <td>{ status: false, code: 2, message: [ { index: x, key: 'invoices[x].payments', message:
                            'پرداخت صورتحساب معتبر نیست' }], data: {} }</td>
                    </tr>
                    <tr>
                        <td>invoices[x].extension (x=ردیف)</td>
                        <td>خالی</td>
                        <td>{ status: false, code: 2, message: [ { index: x, key: 'invoices[x].extension', message:
                            'extension صورتحساب معتبر نیست' }], data: {} }</td>
                    </tr>
                </tbody>
            </table>
            <h4>
                خروجی تابع
            </h4>
            <table class="dir-left">
                <thead>
                    <tr>
                        <th>موفق</th>
                        <th>ناموفق</th>
                        <th>خطا</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>{ status: true, code: 0, data: response, message: ' send invoice success' }
                        </td>
                        <td>{ status: false, code: 1, data: error, message: 'send invoice faided' }
                        </td>
                        <td>{ status: false, data: {}, code: 500, message: err }
                        </td>
                    </tr>
                    <tr>
                        <td>response : دیتای دریافتی از طرف سازمان</td>
                        <td>error : خطای دریافتی از طرف سازمان</td>
                        <td>err : خطای کامپایل در سرور خودمان</td>
                    </tr>
                </tbody>
            </table>
            <h4 style="color: red;">
                نکات مهم ارسال صورت حساب
            </h4>
            <p style="color: red;">
                توجه داشته باشید فیلد هایی که نوع داده decimal باشند را بصورت string به api فرستاده شوند بصورت زیر:
            </p>
            <p>صحیح : "10.0" , "10.05"</p>
            <p> اشتباه : 10.5 , 10 </p>

            <p style="color: red;">برای استفاده از api بایستی فایل کلید خصوصی بصورت زیر در مسیر مورد نظر ذخیره گردد</p>
            <p>keys/A14P7E.key</p>
        </div>
    </div>

    <div class="seprator">

    </div>

    <div id="part-6" class="container">
        <h3>
            استعلام صورتحساب
        </h3>
        <div>
            <table class="dir-left">
                <thead>
                    <tr>
                        <th>
                            url
                        </th>
                        <th>
                            method
                        </th>
                        <th>
                            inputs
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            /inquiry/inquiry_by_uid
                        </td>
                        <td>
                            post
                        </td>
                        <td>
                            {
                            client_id: '...', invoices: [{
                            "fiscalId": "...",
                            "uid": ".."
                            }, {
                            "fiscalId": "...",
                            "uid": ".."
                            }]
                            }
                        </td>
                    </tr>
                </tbody>
            </table>
            <h4>
                validation
            </h4>
            <table class="dir-left">
                <thead>
                    <tr>
                        <th>پارامتر</th>
                        <th>وضعیت</th>
                        <th>پاسخ</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>inputs</td>
                        <td>خالی</td>
                        <td>{ status: false, code: 2, message:[{ key: 'inputs', message: 'پارامترهای ورودی معتبر نیست'
                            }] , data: {} }</td>
                    </tr>
                    <tr>
                        <td>inputs.client_id</td>
                        <td>خالی</td>
                        <td>{ status: false, code: 2, message:[{ key: 'inputs.client_id', message: ' حافظه مالیاتی معتبر
                            نیست' }], data: {} }</td>
                    </tr>
                    <tr>
                        <td>invoices</td>
                        <td>خالی</td>
                        <td>{ status: false, code: 2, message:[{ key: 'invoices', message: ' صورتحساب معتبر نیست' }],
                            data: {} }</td>
                    </tr>
                    <tr>
                        <td>invoices[x].fiscalId (x=ردیف)</td>
                        <td>خالی</td>
                        <td>{ status: false, code: 2, message: [ { index: x, key: 'invoices[x].fiscalId', message: '
                            حافظه مالیاتی معتبر نیست' }], data: {} }</td>
                    </tr>
                    <tr>
                        <td>invoices[x].uid (x=ردیف)</td>
                        <td>خالی</td>
                        <td>{ status: false, code: 2, message: [ { index: x, key: 'invoices[x].uiu', message: ' شناسه
                            صورت حساب معتبر نیست' }], data: {} }</td>
                    </tr>
                </tbody>
            </table>
            <h4>
                خروجی تابع
            </h4>
            <table class="dir-left">
                <thead>
                    <tr>
                        <th>موفق</th>
                        <th>ناموفق</th>
                        <th>خطا</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>{ status: true, code: 0, data: response, message: ' inquiry success' }
                        </td>
                        <td>{ status: false, code: 1, data: error, message: 'inquiry faided' }
                        </td>
                        <td>{ status: false, data: {}, code: 500, message: err }
                        </td>
                    </tr>
                    <tr>
                        <td>response : دیتای دریافتی از طرف سازمان</td>
                        <td>error : خطای دریافتی از طرف سازمان</td>
                        <td>err : خطای کامپایل در سرور خودمان</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</body>

</html>